---
title: "Trabalho Final"
output: html_document
author: "Olívia Silva Amann"
---

FLP0468 Métodos Quantitativos de Pesquisa Política IV

# Reprodução dos modelos de regressão do artigo "O crescimento da direita e o voto em Bolsonaro: causalidade reversa?"

<br> Autores: G. Avelino; J. P. Junior; G. A. Russo <br>

## Introdução

<br> "O Crescimento da direita e o voto em Bolsonaro: causalidade reversa?", como o nome indica, é um artigo que busca inverter a lógica tradicionalmente estabelecida em grande parte da literatura que entende a posição ideológica autodeclarada como causa para a escolha do voto. Para os autores, uma das evidências disso é como, analisando a série histórica (Dados do Barômetro das Américas), no Brasil, não há aumento significativo do posicionamento conservador sobre temas de políticas públicas e costumes sociais, que é tão associada à direita.

<br> Para confirmar suas suspeitas, os autores realizaram surveys, tanto em entrevistas face a face quanto em questionários por telefone, respectivamente Experimentos 1 e 2, totalizando 4922 respondentes, todos de cidades paulistas e realizados em 2019. Nos surveys, constavam perguntas de mapeamento do perfil sociodemográfico, avaliação de satisfação com o presidente (e ex-presidente, no Experimento 2) e escala esquerda-direita para o autoposicionamento. O tratamento utilizado foi informar, antes do posicionamento na escala, como o então presidente Bolsonaro se identificava (direita), além do posicionamento do presidente Lula ou de ambos (também no Experimento 2) enquanto um grupo controle não recebia esse estímulo.

<br> Para este trabalho, reproduzirei as regressões apenas daquele que os autores chamam de "Experimento 1", ou seja, as entrevistas face a face.

## Reprodução das modelagens

### Carregamento de Bibliotecas

```{r warning=FALSE, message=FALSE}
library(haven)
library(dplyr)
library(broom)
#install.packages("ggplot2")
library(ggplot2)
```

### Carregamento de dados

```{r}
cidades_paulistas <- read_sav("2.BD_CausalidadeReversa_PesquisasCidadesPaulistas.sav")
#limpeza de dados
cidades_paulistas <- cidades_paulistas %>%
  mutate(across(where(is.character), ~ na_if(., ""))) %>%   
  mutate(across(where(is.character), ~ na_if(., " "))) %>%   
  mutate(across(where(is.character), ~ na_if(., "  ")))

experimento_1 <- cidades_paulistas %>%
  select(
    #autoposicionamento ideológico
    right, 
    left,
    l1_rec,
    l1_missing,
    l1_nomi,
    #avaliacao do presidente
    m1_cat,
    m1_recode,
    #tratamento
    treatment,
    #informações sociodemográficas
    female,
    age,
    educ_cat,
    income_cat,
    #cidade
    city,
    #neighborhood
  ) %>%
  rename(
    answered = l1_missing,
    l1_cat = l1_nomi,
    l1_desc = l1_rec
  ) %>%
  mutate(
    id=row_number(),
    treatment=factor(treatment),
    age=as.integer(age)
  )
```

Conforme os autores indicam nos apêndices do artigo, dentre as cidades analisadas, uma delas, Santos, não foi usada no artigo, já que seus dados de avaliação do desempenho presidencial tinham categorias diferentes das demais. Portanto, é preciso retirar todas as respostas de Santos da amostra.

```{r}
unique(experimento_1$city)
xp_1_fltr <- subset(experimento_1, city != "Santos")
glimpse(xp_1_fltr)
```

### Regressões logísticas multivariadas

<br> Antes de iniciar a regressão, é preciso determinar o grupo de referência, assim como no artigo, o grupo controle.

```{r}
xp_1_fltr <- xp_1_fltr %>%
  mutate(
    treatment=relevel(treatment, ref="Control")
  )
```

#### Taxa de Respostas

<br> A Taxa de Respostas foi uma das formas que os autores utilizaram para identificar a influência do tratamento para que o respondente se identifique na escala ideológica. O objetivo é fundamentar a hipótese de que reconhecer o Bolsonaro como sendo de direita, impulsiona reações, mesmo que opostas.

<br> Este modelo, chamado aqui de `modelo_1a`, é uma regressão logística multivariada, é   apresentado na sessão de Resultados e busca  estabelecer uma relação de causalidade entre o tratamento e a taxa de respostas na escala de autoidentificação ideológica, independente de qual o valor dessa resposta (Esquerda, Direita ou Centro).

```{r}
modelo_1 <- glm(answered ~ treatment + city + income_cat + educ_cat + age + female,
                     data=xp_1_fltr,
                     family=binomial(link= "logit"))

summary_md1 <- summary(modelo_1)

#visualização em tabela
summary_md1a<- as.data.frame(summary_md1$coefficients)
summary_md1a <- round(summary_md1a, 3)
tabela_taxa_resp <- summary_md1a[
  c("(Intercept)", "treatment"),
  c("Estimate", "Std. Error")
]
tabela_taxa_resp
```
<br> Segundo a tabela 23, no Apêndice G - Análise de Regressão - Taxa de Resposta, a renda não aparece entre as variáveis independentes do modelo. Essa é a razão da diferença entre os meus resultados da taxa de resposta para os presentes no artigo. Isso poderia indicar um viés, mas como podemos perceber, tanto pela regressão acima quanto pela predição abaixo, as diferenças entre ambas as respostas não são significativas:

<br> Para a predição de probabilidades, é necessário indicar os parâmetros de referência. Nos experimentos originais foram usados como padrão uma "mulher de 40 anos, moradora da cidade Guarujá, com ensino superior incompleto ou mais e avaliação “regular” do presidente Bolsonaro"(Avelino; Junior; Russo, 2022, p. 604). Contudo, os autores não indicaram qual o nível de renda parametrizado, mas seguindo a mesma lógica, podemos assumir que seria a renda com maior frequência, de Até 2 SM, como indicado no Apêndice C- Estatísticas Descritivas e Frequências do Estudo 1.

```{r}
moda_renda <- unique(
  xp_1_fltr$income_cat
  )[
    which.max(tabulate(match(
      xp_1_fltr,
      unique(xp_1_fltr$income_cat)
    )))
  ]
moda_renda

persona <- data.frame(
  female = rep('Mulher',2),
  age=rep(40,2),
  city=rep('Guarujá', 2),
  educ_cat=rep('Superior incompleto ou mais', 2),
  m1_cat=rep(3, 2),
  treatment = c('Control', 'Treatment'),
  income_cat = rep(moda_renda, 2)
)

pred_respondeu <- predict(
  modelo_1,
  newdata=persona,
  type="response"
)

pred_respondeu
```
<br> Para reproduzir os resultados originais do estudo e confirmar que a omissão da renda não gera um viés, vou reproduzi-los abaixo e gerar a Tabela x: Comparação entre modelos com e sem renda.

```{r}
modelo_1b <- glm(
  answered ~ treatment + city + educ_cat + age + female,
  data=xp_1_fltr,
  family=binomial(link= "logit"))

summary_md1b <- summary(modelo_1b)


persona$income_cat<- NULL

pred_md_1b <- predict(
  modelo_1b,
  newdata=persona,
  type="response"
)

pred_respondeu

```
<br> Para comparar os resultados:
```{r}
summary_md1b <-as.data.frame(summary_md1b$coefficients)
summary_md1b <- round(summary_md1b, 3)

tabela_comp_taxa_resp <- rbind(
  "Controle – Sem renda" = summary_md1b["(Intercept)", c("Estimate", "Std. Error")],
  "Tratamento – Sem renda" = summary_md1b["treatment", c("Estimate", "Std. Error")],
  "Controle – Com renda" = summary_md1a["(Intercept)", c("Estimate", "Std. Error")],
  "Tratamento – Com renda" = summary_md1a["treatment", c("Estimate", "Std. Error")]
)


knitr::kable(tabela_comp_taxa_resp,
             caption = "Tabela x: Comparação entre estimandos e erros quadrados para os modelos com e sem renda")
```
<br> Apesar de os valores da minha reprodução serem diferentes aos do artigo, isso provavelmente se deve à adoção de alguma forma diferente para tratar os dados. Apesar disso, são valores que estão dentro da taxa de erros estabelecida no artigo. De forma parecida, a diferença entre os modelos com e sem renda também não é estatisticamente significativa, justificando a decisão dos persquisadores de não a utilizarem na regressão.



